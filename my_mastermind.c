/*

|                           ░░░░░░░░░░░░░░░░░░░░░░▒▒░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ▒▒░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░                  ░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░    ▒▒░░░░  ░░▒▒▒▒    ░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░  ▒▒░░░░▒▒▒▒▒▒░░░░▒▒  ░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░    ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒    ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░  ░░▒▒░░░░░░░░░░░░░░▒▒░░  ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░  ▒▒░░▒▒░░▒▒▒▒▒▒░░░░░░▒▒  ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░  ▒▒░░▒▒▒▒░░▒▒▒▒▒▒▒▒░░▒▒  ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░                          ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░      ██████  ██████      ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░    ██████      ██████    ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░    ██████      ██████    ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░            ██            ░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░    ▒▒  ██  ██  ░░    ░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░          ░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░  ░░░░░░░░░░░░░░  ░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░  ░░  ░░  ░░  ░░  ░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░                      ░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░                  ░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░          ░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▒▒░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
|                           ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓
|                           ▓▓▒▒▒▒░░▒▒▒▒▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░▓▓▓▓▓▓
|    
|    
|    ███╗   ███╗██╗   ██╗    ███╗   ███╗ █████╗ ███████╗████████╗███████╗██████╗ ███╗   ███╗██╗███╗   ██╗██████╗ 
|    ████╗ ████║╚██╗ ██╔╝    ████╗ ████║██╔══██╗██╔════╝╚══██╔══╝██╔════╝██╔══██╗████╗ ████║██║████╗  ██║██╔══██╗
|    ██╔████╔██║ ╚████╔╝     ██╔████╔██║███████║███████╗   ██║   █████╗  ██████╔╝██╔████╔██║██║██╔██╗ ██║██║  ██║
|    ██║╚██╔╝██║  ╚██╔╝      ██║╚██╔╝██║██╔══██║╚════██║   ██║   ██╔══╝  ██╔══██╗██║╚██╔╝██║██║██║╚██╗██║██║  ██║
|    ██║ ╚═╝ ██║   ██║       ██║ ╚═╝ ██║██║  ██║███████║   ██║   ███████╗██║  ██║██║ ╚═╝ ██║██║██║ ╚████║██████╔╝
|    ╚═╝     ╚═╝   ╚═╝       ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝   ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝     ╚═╝╚═╝╚═╝  ╚═══╝╚═════╝ 
                                                                                                            
source : https://textart.sh/topic/brain
         https://patorjk.com/software/taag/#p=testall&f=Graffiti&t=My%20mastermind
*/

#include "include/header.h"
#include "include/functions.h"

int main(int argc, char** argv){
    int nb_try = 0, i = 0, try = 10 ;
    int problem[4] = {0};
    srand(clock());
    randomizer(problem);
    intro();  

    for(int y = 2; y < argc; y++){
        i++;
        if(argv[i][0] == '-'){
            for(int x = 1; argv[i][x] != '\0'; x++ ){
                char flag = argv[i][x];
                switch(flag){
                case 't':
                    try = my_ctoi(argv[y],my_strlen(argv[y]));
                break;
                case 'c': 
                    for (int z = 0;z< SIZE; z++){
                        problem[z] = (int)argv[y][z]-48; 
                        }
                break;
                }
            }            
        }
    }
    
    while(nb_try < try){

        write(1,"Round ",6);
        
        char buffer[5] = {0};
        their_itoa(nb_try, buffer, 10);
        int sizen = my_strlen(buffer);
        write(1, buffer,sizen);
        write(1,"\n",1);
        write(1,">",1);
        int test = 0;
        char user_input_buffer[SIZE] = {0};
        char escape_catcher[10] = {0};
        
        while(test < 1){

            read(0,user_input_buffer,4);
            
            if(isnotint(user_input_buffer) == 0){
                write(1,"wrong input !",14);
               
            };
            test = isnotint(user_input_buffer);
            read(0,escape_catcher,10);
            write(1,"\n",1); 
        }

        int count_return = check_input(user_input_buffer, problem);
        if(count_return == SIZE){ victory();return EXIT_SUCCESS;}
        write(1,"---\n",4);
        nb_try++;
    }

    return EXIT_FAILURE;
}